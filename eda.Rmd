---
title: "EDA of Home Loan Approvals"
author: "Emily Chen, Kashish Garg, Christian Manaog"
date: "2/23/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Data Cleaning

We will delete rows that do not have any information about race. This should be okay because there are approximately 1.3 million rows of empty race information, and we will still have ~8.7 million rows.

We will drop ethnicity as well since this is encaptured by race. 

## Removing NAs


```{r data clean, eval= FALSE}
hmda <- read_csv("hmda_lar.csv")

na_str <- "Information not provided by applicant in mail, Internet, or telephone application"
# Remove NA/not provided rows
new_hmda <- hmda %>% subset(!(applicant_race_name_1 %in% c(na_str, "Not applicable")))

# NAs
apply(is.na(new_hmda), 2, function(x) sum(x) /nrow(new_hmda))

# Removing bad columns (> 99% na)
new_hmda <-new_hmda %>% select(-respondent_id, -edit_status_name, -co_applicant_race_name_3,
                               -application_date_indicator, -applicant_race_name_4, -co_applicant_race_name_5,
                               -co_applicant_race_name_2, -applicant_race_name_3, -co_applicant_race_name_4,
                               -applicant_race_name_5, -applicant_race_name_2)

# Removing na_str from dataframe
new_hmda <- new_hmda %>% subset(!(applicant_ethnicity_name %in% c(na_str, "Not applicable")))
new_hmda <- new_hmda %>% subset(!(applicant_sex_name %in% c(na_str)))
new_hmda <- new_hmda %>% subset(!(co_applicant_race_name_1 %in% c(na_str)))
new_hmda <- new_hmda %>% subset(!(co_applicant_sex_name %in% c(na_str)))

# Only run if you want to save cleaned file
write.csv(new_hmda, file = "hmda_cleaned.csv")
```


```{r}
loan <- read_csv("hmda_cleaned.csv", n_max = 10000)
summary(loan)
```





















